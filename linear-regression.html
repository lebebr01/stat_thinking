<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Linear Regression | Statistical Reasoning through Computation and R</title>
  <meta name="description" content="Chapter 7 Linear Regression | Statistical Reasoning through Computation and R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Linear Regression | Statistical Reasoning through Computation and R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="true" />
  
  
  <meta name="github-repo" content="lebebr01/stat_thinking" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Linear Regression | Statistical Reasoning through Computation and R" />
  
  
  

<meta name="author" content="Brandon LeBeau and Andrew S. Zieffler" />


<meta name="date" content="2021-03-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regression-trees.html"/>
<link rel="next" href="estimation-bootstrap-and-uncertainty.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.17/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-43425299-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-43425299-4');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Reasoning through Computation and R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#statistics-vs-data-science"><i class="fa fa-check"></i><b>1.1</b> Statistics vs Data Science</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#experiments-vs-observations"><i class="fa fa-check"></i><b>1.2</b> Experiments vs Observations</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#data-structure"><i class="fa fa-check"></i><b>1.3</b> Data Structure</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>2</b> Visualization</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="visualization.html"><a href="visualization.html#college-scorecard-data"><i class="fa fa-check"></i><b>2.0.1</b> College Scorecard Data</a></li>
<li class="chapter" data-level="2.0.2" data-path="visualization.html"><a href="visualization.html#view-the-data"><i class="fa fa-check"></i><b>2.0.2</b> View the Data</a></li>
<li class="chapter" data-level="2.1" data-path="visualization.html"><a href="visualization.html#exploring-attributes"><i class="fa fa-check"></i><b>2.1</b> Exploring Attributes</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="visualization.html"><a href="visualization.html#histograms"><i class="fa fa-check"></i><b>2.1.1</b> Histograms</a></li>
<li class="chapter" data-level="2.1.2" data-path="visualization.html"><a href="visualization.html#interpretting-histograms"><i class="fa fa-check"></i><b>2.1.2</b> Interpretting Histograms</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="visualization.html"><a href="visualization.html#plot-customization"><i class="fa fa-check"></i><b>2.2</b> Plot Customization</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="visualization.html"><a href="visualization.html#axes-labels"><i class="fa fa-check"></i><b>2.2.1</b> Axes labels</a></li>
<li class="chapter" data-level="2.2.2" data-path="visualization.html"><a href="visualization.html#plot-title-and-subtitle"><i class="fa fa-check"></i><b>2.2.2</b> Plot title and subtitle</a></li>
<li class="chapter" data-level="2.2.3" data-path="visualization.html"><a href="visualization.html#plot-theme"><i class="fa fa-check"></i><b>2.2.3</b> Plot theme</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="visualization.html"><a href="visualization.html#density-plots"><i class="fa fa-check"></i><b>2.3</b> Density plots</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html"><i class="fa fa-check"></i><b>3</b> Descriptive Statistics: Numerically Describing the Sample Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#summarizing-attributes"><i class="fa fa-check"></i><b>3.1</b> Summarizing Attributes</a></li>
<li class="chapter" data-level="3.2" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#understanding-the-median-and-mean"><i class="fa fa-check"></i><b>3.2</b> Understanding the Median and Mean</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#summarize-with-the-mean-or-median"><i class="fa fa-check"></i><b>3.2.1</b> Summarize with the Mean or Median?</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#numerically-summarizing-variation"><i class="fa fa-check"></i><b>3.3</b> Numerically Summarizing Variation</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#range"><i class="fa fa-check"></i><b>3.3.1</b> Range</a></li>
<li class="chapter" data-level="3.3.2" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#percentile-range"><i class="fa fa-check"></i><b>3.3.2</b> Percentile Range</a></li>
<li class="chapter" data-level="3.3.3" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#interquartile-range-iqr"><i class="fa fa-check"></i><b>3.3.3</b> Interquartile Range (IQR)</a></li>
<li class="chapter" data-level="3.3.4" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#empirical-cumulative-density"><i class="fa fa-check"></i><b>3.3.4</b> Empirical Cumulative Density</a></li>
<li class="chapter" data-level="3.3.5" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#variance-and-standard-deviation"><i class="fa fa-check"></i><b>3.3.5</b> Variance and Standard Deviation</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#summarizing-categorical-attributes"><i class="fa fa-check"></i><b>3.4</b> Summarizing Categorical Attributes</a></li>
<li class="chapter" data-level="3.5" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#advanced-extension-computing-your-own-measure-of-variation"><i class="fa fa-check"></i><b>3.5</b> Advanced Extension: Computing Your Own Measure of Variation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html"><i class="fa fa-check"></i><b>4</b> Multivariate Visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#multivariate-distributions"><i class="fa fa-check"></i><b>4.1</b> Multivariate Distributions</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#histograms-1"><i class="fa fa-check"></i><b>4.1.1</b> Histograms</a></li>
<li class="chapter" data-level="4.1.2" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#density-curves"><i class="fa fa-check"></i><b>4.1.2</b> Density Curves</a></li>
<li class="chapter" data-level="4.1.3" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#violin-plots"><i class="fa fa-check"></i><b>4.1.3</b> Violin Plots</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#faceting"><i class="fa fa-check"></i><b>4.2</b> Faceting</a></li>
<li class="chapter" data-level="4.3" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#multivariate-descriptive-statistics"><i class="fa fa-check"></i><b>4.3</b> Multivariate Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#adding-additional-groups"><i class="fa fa-check"></i><b>4.3.1</b> Adding additional groups</a></li>
<li class="chapter" data-level="4.3.2" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#adding-more-descriptive-statistics"><i class="fa fa-check"></i><b>4.3.2</b> Adding more descriptive statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>5</b> Classification</a>
<ul>
<li class="chapter" data-level="5.1" data-path="classification.html"><a href="classification.html#topic-decision-trees"><i class="fa fa-check"></i><b>5.1</b> Topic: Decision Trees</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="classification.html"><a href="classification.html#fitting-a-classification-tree"><i class="fa fa-check"></i><b>5.1.1</b> Fitting a Classification Tree</a></li>
<li class="chapter" data-level="5.1.2" data-path="classification.html"><a href="classification.html#accuracy"><i class="fa fa-check"></i><b>5.1.2</b> Accuracy</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="classification.html"><a href="classification.html#adding-categorical-attributes"><i class="fa fa-check"></i><b>5.2</b> Adding Categorical Attributes</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="classification.html"><a href="classification.html#exploring-location"><i class="fa fa-check"></i><b>5.2.1</b> Exploring Location</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="classification.html"><a href="classification.html#comparison-to-baseline"><i class="fa fa-check"></i><b>5.3</b> Comparison to Baseline</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="classification.html"><a href="classification.html#absolute-vs-relative-comparison"><i class="fa fa-check"></i><b>5.3.1</b> Absolute vs Relative Comparison</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="classification.html"><a href="classification.html#trainingtest-data"><i class="fa fa-check"></i><b>5.4</b> Training/Test Data</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="classification.html"><a href="classification.html#splitting-the-data-into-trainingtest"><i class="fa fa-check"></i><b>5.4.1</b> Splitting the data into training/test</a></li>
<li class="chapter" data-level="5.4.2" data-path="classification.html"><a href="classification.html#evaluate-accuracy-on-the-testing-data"><i class="fa fa-check"></i><b>5.4.2</b> Evaluate accuracy on the testing data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="classification.html"><a href="classification.html#introduction-to-resamplingbootstrap"><i class="fa fa-check"></i><b>5.5</b> Introduction to Resampling/Bootstrap</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="classification.html"><a href="classification.html#bootstrap-variation-in-prediction-accuracy"><i class="fa fa-check"></i><b>5.5.1</b> Bootstrap variation in prediction accuracy</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regression-trees.html"><a href="regression-trees.html"><i class="fa fa-check"></i><b>6</b> Regression Trees</a>
<ul>
<li class="chapter" data-level="6.1" data-path="regression-trees.html"><a href="regression-trees.html#predicting-act-score"><i class="fa fa-check"></i><b>6.1</b> Predicting ACT Score</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="regression-trees.html"><a href="regression-trees.html#loading-r-packages"><i class="fa fa-check"></i><b>6.1.1</b> Loading R packages</a></li>
<li class="chapter" data-level="6.1.2" data-path="regression-trees.html"><a href="regression-trees.html#visualize-distributions"><i class="fa fa-check"></i><b>6.1.2</b> Visualize distributions</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="regression-trees.html"><a href="regression-trees.html#continuous-association"><i class="fa fa-check"></i><b>6.2</b> Continuous Association</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="regression-trees.html"><a href="regression-trees.html#correlation-computation"><i class="fa fa-check"></i><b>6.2.1</b> Correlation Computation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="regression-trees.html"><a href="regression-trees.html#first-regression-tree"><i class="fa fa-check"></i><b>6.3</b> First Regression Tree</a></li>
<li class="chapter" data-level="6.4" data-path="regression-trees.html"><a href="regression-trees.html#evaluating-accuracy"><i class="fa fa-check"></i><b>6.4</b> Evaluating accuracy</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="regression-trees.html"><a href="regression-trees.html#conditional-error"><i class="fa fa-check"></i><b>6.4.1</b> Conditional Error</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="regression-trees.html"><a href="regression-trees.html#adding-more-attributes"><i class="fa fa-check"></i><b>6.5</b> Adding more attributes</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>7</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="linear-regression.html"><a href="linear-regression.html#simple-regression-continuous-predictor"><i class="fa fa-check"></i><b>7.1</b> Simple Regression continuous predictor</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="linear-regression.html"><a href="linear-regression.html#description-of-the-data"><i class="fa fa-check"></i><b>7.1.1</b> Description of the Data</a></li>
<li class="chapter" data-level="7.1.2" data-path="linear-regression.html"><a href="linear-regression.html#scatterplots"><i class="fa fa-check"></i><b>7.1.2</b> Scatterplots</a></li>
<li class="chapter" data-level="7.1.3" data-path="linear-regression.html"><a href="linear-regression.html#fitting-a-linear-regression-model"><i class="fa fa-check"></i><b>7.1.3</b> Fitting a linear regression model</a></li>
<li class="chapter" data-level="7.1.4" data-path="linear-regression.html"><a href="linear-regression.html#explore-the-y-intercept"><i class="fa fa-check"></i><b>7.1.4</b> Explore the y-intercept</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="linear-regression.html"><a href="linear-regression.html#conditional-means"><i class="fa fa-check"></i><b>7.2</b> Conditional Means</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html"><i class="fa fa-check"></i><b>8</b> Estimation, Bootstrap and Uncertainty</a>
<ul>
<li class="chapter" data-level="8.1" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#bootstrap-and-uncertainty"><i class="fa fa-check"></i><b>8.1</b> Bootstrap and Uncertainty</a></li>
<li class="chapter" data-level="8.2" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#estimating-error-or-uncertainty"><i class="fa fa-check"></i><b>8.2</b> Estimating Error or uncertainty</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#resample-with-replacement"><i class="fa fa-check"></i><b>8.2.1</b> Resample with replacement</a></li>
<li class="chapter" data-level="8.2.2" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#calculate-statistic-of-interest"><i class="fa fa-check"></i><b>8.2.2</b> Calculate statistic of interest</a></li>
<li class="chapter" data-level="8.2.3" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#replicating-the-resamplingbootstrap"><i class="fa fa-check"></i><b>8.2.3</b> Replicating the resampling/bootstrap</a></li>
<li class="chapter" data-level="8.2.4" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#linear-regression-bootstrapresampling-example"><i class="fa fa-check"></i><b>8.2.4</b> Linear regression bootstrap/resampling example</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#categorical-predictors"><i class="fa fa-check"></i><b>8.3</b> Categorical Predictor(s)</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#linear-regression---categorical-predictor"><i class="fa fa-check"></i><b>8.3.1</b> Linear Regression - Categorical Predictor</a></li>
<li class="chapter" data-level="8.3.2" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#inference"><i class="fa fa-check"></i><b>8.3.2</b> Inference</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#more-than-2-categorical-groups"><i class="fa fa-check"></i><b>8.4</b> More than 2 categorical groups</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#explore-distribution-3-groups"><i class="fa fa-check"></i><b>8.4.1</b> Explore distribution 3 groups</a></li>
<li class="chapter" data-level="8.4.2" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#overall-model-fit"><i class="fa fa-check"></i><b>8.4.2</b> Overall model fit</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#multiple-regression"><i class="fa fa-check"></i><b>8.5</b> Multiple Regression</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#interactions"><i class="fa fa-check"></i><b>8.5.1</b> Interactions</a></li>
<li class="chapter" data-level="8.5.2" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#evaluating-model-fit"><i class="fa fa-check"></i><b>8.5.2</b> Evaluating model fit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="prediction-for-individuals.html"><a href="prediction-for-individuals.html"><i class="fa fa-check"></i><b>9</b> Prediction for individuals</a>
<ul>
<li class="chapter" data-level="9.1" data-path="prediction-for-individuals.html"><a href="prediction-for-individuals.html#comparison-of-classification-linear-model"><i class="fa fa-check"></i><b>9.1</b> Comparison of classification / linear model</a></li>
<li class="chapter" data-level="9.2" data-path="prediction-for-individuals.html"><a href="prediction-for-individuals.html#compared-linear-model-with-median"><i class="fa fa-check"></i><b>9.2</b> Compared linear model with median</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="prediction-for-individuals.html"><a href="prediction-for-individuals.html#skewed-data---inference"><i class="fa fa-check"></i><b>9.2.1</b> Skewed Data - Inference</a></li>
<li class="chapter" data-level="9.2.2" data-path="prediction-for-individuals.html"><a href="prediction-for-individuals.html#bootstrap-median"><i class="fa fa-check"></i><b>9.2.2</b> Bootstrap Median</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Reasoning through Computation and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-regression" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Linear Regression</h1>
<p>Linear regression is another statistical model that can be used when the outcome is an integer or continuous, similar to that of the regression tree. There are similarities between linear regression and regression trees, however there are also very notable differences.</p>
<p>Linear regression and regression trees are both used when the outcome is continuous or continuous. These methods are both able to make predictions for the outcome and identify which attributes are most important in aiding in making those predictions. There are differences though in the two methods that are important to distinguish. Linear regression makes an assumption on the relationship between the outcome and attributes entered into the model. Linear regression, as in the name, assumes that the relationship between the outcome and an attribute is linearly related.<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a> Regression trees however do not directly make this linear assumption between the outcome and an attribute. This assumption can make linear regression more parsimonious, meaning that the model can be simpler, which is often a goal of science, to explain the phenomenon of interest with the simplest possible explanation.</p>
<div id="simple-regression-continuous-predictor" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Simple Regression continuous predictor</h2>
<div id="description-of-the-data" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Description of the Data</h3>
<p>These data contain information on mother’s and baby’s health for 1,174 pregnant women.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="linear-regression.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb166-2"><a href="linear-regression.html#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula)</span>
<span id="cb166-3"><a href="linear-regression.html#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb166-4"><a href="linear-regression.html#cb166-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsample)</span>
<span id="cb166-5"><a href="linear-regression.html#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statthink)</span>
<span id="cb166-6"><a href="linear-regression.html#cb166-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-7"><a href="linear-regression.html#cb166-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set theme for plots</span></span>
<span id="cb166-8"><a href="linear-regression.html#cb166-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_statthinking</span>())</span>
<span id="cb166-9"><a href="linear-regression.html#cb166-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-10"><a href="linear-regression.html#cb166-10" aria-hidden="true" tabindex="-1"></a>us_weather <span class="ot">&lt;-</span> <span class="fu">mutate</span>(us_weather, <span class="at">snow_factor =</span> <span class="fu">factor</span>(snow), </span>
<span id="cb166-11"><a href="linear-regression.html#cb166-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">snow_numeric =</span> <span class="fu">ifelse</span>(snow <span class="sc">==</span> <span class="st">&#39;Yes&#39;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code></pre></div>
</div>
<div id="scatterplots" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Scatterplots</h3>
<p>As we’ve explored before, scatterplots help to explore the relationship between two continuous, quantitative data attributes. These are created with the <code>gf_point()</code> function and adding lines to the figure to provide some guidance to the relationship between the two attributes can be done with the <code>gf_smooth()</code> function. Below, a scatterplot is created that explores the relationship between the low temperature and the average daily dew point.<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a></p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="linear-regression.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(drybulbtemp_min <span class="sc">~</span> dewpoint_avg, <span class="at">data =</span> us_weather, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb167-2"><a href="linear-regression.html#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb167-3"><a href="linear-regression.html#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_labs</span>(<span class="at">x =</span> <span class="st">&quot;Average daily dew point&quot;</span>,</span>
<span id="cb167-4"><a href="linear-regression.html#cb167-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Minimum daily temperature (in F)&quot;</span>)</span></code></pre></div>
<p><img src="07-linear-regression_files/figure-html/scatter-temp-1.png" width="672" /></p>
<p>Figure <a href="#fig:scatter-temp"><strong>??</strong></a> shows the relationship between minimum temperature and average daily dew point assuming a linear relationship (specified with <code>gf_smooth(method = 'lm')</code>) between the two attributes. In this example, the relationship between the two attributes goes from the lower left to the upper right, indicating a positive relationship. That is, as the average daily dew point tends to increase, the minimum daily temperature also tends to increase. The relationship is not perfect, which is shown by the points not falling perfectly on the blue line, but the data are clustered relatively closely to this blue line. This would suggest that the relationship is stronger rather than being weaker and closer to +1 than 0.</p>
<p>To estimate as a single quantity the relationship between the two attributes, the correlation can be calculated with the <code>cor()</code> function with the primary argument being a formula depicting the two variables to compute the correlation. The optional argument, <code>use = 'complete.obs'</code> is used as there are some missing data on these attributes and these data are removed prior to the calculation.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="linear-regression.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(drybulbtemp_min <span class="sc">~</span> dewpoint_avg, <span class="at">data =</span> us_weather, </span>
<span id="cb168-2"><a href="linear-regression.html#cb168-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">use =</span> <span class="st">&#39;complete.obs&#39;</span>)</span></code></pre></div>
<pre><code>## [1] 0.9102476</code></pre>
<p>Here the correlation represents the degree of <strong>linear</strong> relationship between the two variables. Values closer to 1 in absolute value (i.e. +1 or -1) show a stronger linear relationship and values closer to 0 indicate no relationship or weaker relationship. The correlation between the two variables above was about 0.91 indicating that there is a strong positive linear relationship between the minimum temperature and the daily dew point. The correlation is shown to be positive due to the coefficient being positive and the general trend from the scatterplot shows a direction of relationship moving from the lower left of the figure to the upper right of the figure. A negative correlation would have a negative sign associated with it and would trend from the upper left to the lower right of a scatterplot.</p>
</div>
<div id="fitting-a-linear-regression-model" class="section level3" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> Fitting a linear regression model</h3>
<p>Now that the correlation was computed, we have evidence that there is a relationship between the minimum temperature and the average daily dew point. To provide some more evidence about the strength of this relationship and how much error is involved, fitting a linear regression model is often done. This can be done with the <code>lm()</code> function where the two arguments that need to be specified are a formula and the data to use for the model fitting. The formula takes the following form: <code>drybulbtemp_min ~ dewpoint_avg</code>, where the minimum temperature is the outcome of interest (in language we’ve used previously, this is the attribute we want to predict) and the average daily dew point is the attribute we want to use to help to predict the minimum temperature. Another way to think about what these variables represent is to explain variation in the minimum temperature with the average daily dew point. In other words, the assumption is made that the average daily dew point impacts or explains differences in the minimum temperature.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="linear-regression.html#cb170-1" aria-hidden="true" tabindex="-1"></a>temp_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(drybulbtemp_min <span class="sc">~</span> dewpoint_avg, </span>
<span id="cb170-2"><a href="linear-regression.html#cb170-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> us_weather)</span>
<span id="cb170-3"><a href="linear-regression.html#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(temp_reg)</span></code></pre></div>
<pre><code>##  (Intercept) dewpoint_avg 
##    4.8343103    0.8999469</code></pre>
<p>The following coefficients represent the linear regression equation that more generally can be show as:</p>
<p><span class="math display">\[\begin{equation}
drybulbtemp\_min = 4.83 + 0.90 dewpoint\_avg + \epsilon
\end{equation}\]</span></p>
<p>The equation can also be represented without the error, <span class="math inline">\(\epsilon\)</span> as:</p>
<p>begin{equation}
 = 4.83 + 0.90 dewpoint_avg
\end{equation}</p>
<p>where now the minimum temperature outcome has a hat (i.e. <span class="math inline">\(\hat{y}\)</span>) that denotes mathematically that the equation predicts a value of minimum temperature given solely the average daily dew point. The first equation above says that the original observed minimum temperature is a function of the average daily dew point plus some error. Using the equation above, the predicted minimum temperature can be obtained by including a value inserted for the average daily dew point. Let’s pick a few values for the average daily dew point to try.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="linear-regression.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fl">4.83</span> <span class="sc">+</span> <span class="fl">0.90</span> <span class="sc">*</span> <span class="sc">-</span><span class="dv">15</span></span></code></pre></div>
<pre><code>## [1] -8.67</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="linear-regression.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fl">4.83</span> <span class="sc">+</span> <span class="fl">0.90</span> <span class="sc">*</span> <span class="dv">0</span></span></code></pre></div>
<pre><code>## [1] 4.83</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="linear-regression.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fl">4.83</span> <span class="sc">+</span> <span class="fl">0.90</span> <span class="sc">*</span> <span class="dv">25</span></span></code></pre></div>
<pre><code>## [1] 27.33</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="linear-regression.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fl">4.83</span> <span class="sc">+</span> <span class="fl">0.90</span> <span class="sc">*</span> <span class="dv">26</span></span></code></pre></div>
<pre><code>## [1] 28.23</code></pre>
<p>You may notice that the predicted value of minimum temperature increases by 0.90 degrees Fahrenheit for every one degree increase in average daily dew point, often referred to as the linear slope. The predicted values would fit on the line shown in Figure <a href="#fig:scatter-temp"><strong>??</strong></a>. This highlights the assumption made from the linear regression model in which the relationship between the minimum temperature and the average daily dew point is assumed to be linear. It is possible to relax this assumption with a more complicated model, however that is not explored here. The y-intercept, shown as 4.83 in the equations above will be explored in the next section.</p>
</div>
<div id="explore-the-y-intercept" class="section level3" number="7.1.4">
<h3><span class="header-section-number">7.1.4</span> Explore the y-intercept</h3>
<p>So far the discussion has focused on the linear slope, often a term that is of most interest. However, the y-intercept can also be an important term. The y-intercept from the equations above when the minimum temperature was predicted or explained by the average daily dew point was 4.83. What does this term mean? Exploring the scatterplot can provide some insight to the interpretation of the intercept.</p>
<p>Figure <a href="#fig:scatter-temp-int"><strong>??</strong></a> shows a scatterplot where the y-axis is the minimum temperature and the x-axis is the average daily dew point. This figure shows a horizontal and vertical line that cross on the blue line shown in the figure. The vertical line is shown at an average daily dew point of 0 and the horizontal line is at a minimum temperature at 4.83. These cross or intersect on the blue line which represents the relationship between the average daily dew point and the minimum temperature. This depicts what the y-intercept is, the y-intercept represents the average minimum temperature for an average daily dew point of 0. More generally, the y-intercept is the <em>average value of the outcome when all of the attributes included in the linear regression are 0</em>.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="linear-regression.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(drybulbtemp_min <span class="sc">~</span> dewpoint_avg, <span class="at">data =</span> us_weather, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb180-2"><a href="linear-regression.html#cb180-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb180-3"><a href="linear-regression.html#cb180-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb180-4"><a href="linear-regression.html#cb180-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_hline</span>(<span class="at">yintercept =</span> <span class="fl">4.83</span>) <span class="sc">%&gt;%</span></span>
<span id="cb180-5"><a href="linear-regression.html#cb180-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_labs</span>(<span class="at">x =</span> <span class="st">&quot;Average daily dew point&quot;</span>,</span>
<span id="cb180-6"><a href="linear-regression.html#cb180-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Minimum daily temperature (in F)&quot;</span>)</span></code></pre></div>
<p><img src="07-linear-regression_files/figure-html/scatter-temp-int-1.png" width="672" /></p>
<p>In the example that has been explored so far, a value of 0 for the average daily dew point occurs within the sample of data. That is, an average daily dew point of 0 occurs in the data are is directly interpretable. This would mean that when an average daily dew point of 0 happens in real life, the minimum temperature is 4.83 degrees Fahrenheit on average for the data that is included in this sample. There are situations where a value of 0 for an attribute is not plausible to occur. An example could be predicting a baby’s birth weight based on the number of gestation days.<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a> In situations where the value of 0 is not plausible or meaningful, the data can be centered on a value that is more meaningful or plausible to help with the interpretation of the y-intercept.</p>
<p>Before this is done, below is a more concrete example that still tries to predict/explain minimum temperature, but now the attribute to explain differences in the minimum temperature is the average daily sea level pressure. Sea-level pressure is a way to measure atmospheric pressure and is measured in inches of mercury<a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a>. Figure <a href="#fig:scatter-temp-pressure"><strong>??</strong></a> shows a scatterplot of this relationship. First, notice that the direction of the blue line is different than before, it starts in the upper left quadrant and decreases as the sea level pressure increases. This is indicative of a negative relationship between the two attributes. The correlation can be estimated to be -0.38, a moderate negative relationship. This relationship is not as strong as the relationship between minimum temperature and average daily dew point. The variation around the blue line in <a href="#fig:scatter-temp-pressure"><strong>??</strong></a> is much larger which depicts a weaker relationship (ie., more error) compared to the minimum temperature and dew point relationship (see Figure <a href="#fig:scatter-temp"><strong>??</strong></a>).</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="linear-regression.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(drybulbtemp_min <span class="sc">~</span> sealevelpressure_avg, <span class="at">data =</span> us_weather, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-2"><a href="linear-regression.html#cb181-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-3"><a href="linear-regression.html#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_labs</span>(<span class="at">x =</span> <span class="st">&quot;Average daily sea level pressure&quot;</span>,</span>
<span id="cb181-4"><a href="linear-regression.html#cb181-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Minimum daily temperature (in F)&quot;</span>)</span></code></pre></div>
<p><img src="07-linear-regression_files/figure-html/scatter-temp-pressure-1.png" width="672" /></p>
<p>If a linear regression is estimated with these two attributes, the following coefficients and resulting regression equation can be generated.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="linear-regression.html#cb182-1" aria-hidden="true" tabindex="-1"></a>sea_temp <span class="ot">&lt;-</span> <span class="fu">lm</span>(drybulbtemp_min <span class="sc">~</span> sealevelpressure_avg, <span class="at">data =</span> us_weather)</span>
<span id="cb182-2"><a href="linear-regression.html#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(sea_temp)</span></code></pre></div>
<pre><code>##          (Intercept) sealevelpressure_avg 
##            660.05123            -21.05011</code></pre>
<p><span class="math display">\[\begin{equation}
drybulbtemp\_min = 660.05 - 21.05 sealevelpressure\_avg + \epsilon
\end{equation}\]</span></p>
<p>For these, the y-intercept is about 660 degrees Fahrenheit and the linear slope is about -21 degrees Fahrenheit. How are these interpreted? Starting first with the linear slope, the -21 means that for every one unit increase in sea level pressure (ie., moving from 29 to 30 inches of mercury), the average minimum temperature decreases by 21 degrees Fahrenheit.</p>
<p>Why is the y-intercept 660 degrees Fahrenheit, a temperature that is much above the boiling point of water and is hotter than most ovens. Furthermore, this is not an atmospheric temperature that we have seen in the data, so why is the y-intercept 660 degrees Fahrenheit? Ultimately, this comes down to the range of sea level pressure, where the minimum value in the data is 29.02, a value very far from 0. Therefore, the linear relationship depicted above is extrapolated outside the range of the data (ie, decreased by 29.02 sea level units) which increases the temperature by 610.871 degrees Fahrenheit units. This value is not interpretable or meaningful as it would not be possible to get a sea level pressure of 0 in the metric of inches of mercury. It is possible to modify the data, but not change the overall relationship between minimum temperature and sea level pressure to help increase the interpretation of the y-intercept. Three options will be explored, mean value centered, minimum value centered, and maximum value centered, although there are many other potential options.</p>
<div id="mean-center-sea-level-pressure" class="section level4" number="7.1.4.1">
<h4><span class="header-section-number">7.1.4.1</span> Mean center sea level pressure</h4>
<p>First, mean centering the x attribute can often be a way to make the y-intercept more interpretable. The code below shows a scatterplot by subtracting the mean from all the values of sea level pressure. More explicitly, the value of 30.04 was subtracted from each sea level pressure value in the data.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="linear-regression.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(drybulbtemp_min <span class="sc">~</span> <span class="fu">I</span>(sealevelpressure_avg <span class="sc">-</span> <span class="fu">mean</span>(sealevelpressure_avg, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb184-2"><a href="linear-regression.html#cb184-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> us_weather, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb184-3"><a href="linear-regression.html#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb184-4"><a href="linear-regression.html#cb184-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_labs</span>(<span class="at">x =</span> <span class="st">&quot;Average daily sea level pressure&quot;</span>,</span>
<span id="cb184-5"><a href="linear-regression.html#cb184-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Minimum daily temperature (in F)&quot;</span>)</span></code></pre></div>
<p><img src="07-linear-regression_files/figure-html/scatter-mean-center-1.png" width="672" /></p>
<p>Notice that the relationship is the same as before, but now the scale of sea level pressure is different. From the coefficients shown below, notice that the linear slope is the same as before, -21.05, showing that the subtraction of the mean for each value did not impact the overall relationship between the two attributes. The difference, is now the y-intercept is much smaller and would represent the mean minimum temperature when the mean-centered sea level pressure is 0 (ie., a value of 30.04 in the original metric).</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="linear-regression.html#cb185-1" aria-hidden="true" tabindex="-1"></a>sealevel_reg_centered <span class="ot">&lt;-</span> <span class="fu">lm</span>(drybulbtemp_min <span class="sc">~</span> <span class="fu">I</span>(sealevelpressure_avg <span class="sc">-</span> <span class="fu">mean</span>(sealevelpressure_avg, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb185-2"><a href="linear-regression.html#cb185-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> us_weather)</span>
<span id="cb185-3"><a href="linear-regression.html#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(sealevel_reg_centered)</span></code></pre></div>
<pre><code>##                                                        (Intercept) 
##                                                           27.63117 
## I(sealevelpressure_avg - mean(sealevelpressure_avg, na.rm = TRUE)) 
##                                                          -21.05011</code></pre>
<p>The new equation would look like:</p>
<p>begin{equation}
 = 27.63 - 21.05 (sealevelpressure_avg - mean(sealevelpressure_avg))
\end{equation}</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="linear-regression.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fl">27.63</span> <span class="sc">-</span> <span class="fl">21.05</span> <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span></span></code></pre></div>
<pre><code>## [1] 48.68</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="linear-regression.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fl">27.63</span> <span class="sc">-</span> <span class="fl">21.05</span> <span class="sc">*</span> <span class="dv">0</span></span></code></pre></div>
<pre><code>## [1] 27.63</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="linear-regression.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fl">27.63</span> <span class="sc">-</span> <span class="fl">21.05</span> <span class="sc">*</span> .<span class="dv">5</span></span></code></pre></div>
<pre><code>## [1] 17.105</code></pre>
<p>This can provide an intercept that is more interpretable and can be a model parameter that is of direct interest. The value for the y-intercept also makes more intuitive sense, which can aid in model interpretation. It should be kept in mind that this model would fit the data the same as before, that is, this model is not inherently better. Instead the benefits of this model is simply in the interpretation and intuitiveness of the y-intercept. The regression line that has been shown in the scatterplots in Figures <a href="#fig:scatter-temp-pressure"><strong>??</strong></a> and <a href="#fig:scatter-mean-center"><strong>??</strong></a> are the same ones.</p>
</div>
<div id="minimum-or-maximum-centered-sea-level-pressure" class="section level4" number="7.1.4.2">
<h4><span class="header-section-number">7.1.4.2</span> Minimum or Maximum centered sea level pressure</h4>
<p>Mean centering an attribute can be an attractive way to make the y-intercept more intuitive and interpretable, but it is not the only option. A few other options that are common include subtracting the minimum or maximum values from the predictor attribute. These are shown below, starting first with the minimum centered and then the maximum centered regression.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="linear-regression.html#cb193-1" aria-hidden="true" tabindex="-1"></a>sealevel_reg_min <span class="ot">&lt;-</span> <span class="fu">lm</span>(drybulbtemp_min <span class="sc">~</span> <span class="fu">I</span>(sealevelpressure_avg <span class="sc">-</span> <span class="fu">min</span>(sealevelpressure_avg, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb193-2"><a href="linear-regression.html#cb193-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> us_weather)</span>
<span id="cb193-3"><a href="linear-regression.html#cb193-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(sealevel_reg_min)</span></code></pre></div>
<pre><code>##                                                       (Intercept) 
##                                                          49.17705 
## I(sealevelpressure_avg - min(sealevelpressure_avg, na.rm = TRUE)) 
##                                                         -21.05011</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="linear-regression.html#cb195-1" aria-hidden="true" tabindex="-1"></a>sealevel_reg_max <span class="ot">&lt;-</span> <span class="fu">lm</span>(drybulbtemp_min <span class="sc">~</span> <span class="fu">I</span>(sealevelpressure_avg <span class="sc">-</span> <span class="fu">max</span>(sealevelpressure_avg, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb195-2"><a href="linear-regression.html#cb195-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> us_weather)</span>
<span id="cb195-3"><a href="linear-regression.html#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(sealevel_reg_max)</span></code></pre></div>
<pre><code>##                                                       (Intercept) 
##                                                          11.28686 
## I(sealevelpressure_avg - max(sealevelpressure_avg, na.rm = TRUE)) 
##                                                         -21.05011</code></pre>
<p>Two main takeaways from these two new models. First, the relationship between the minimum temperature and the sea level pressure does not change. The average change in the minimum temperature for a unit change of sea level pressure is still 21 degrees Fahrenheit and the relationship is always negative. The element that changes is the y-intercept. For the minimum centered model, the y-intercept is 49.18 degrees Fahrenheit. The interpretation is that when the sea level pressure has a value of 0 (ie., a value of 29.02 in the original metric), the average minimum temperature is 49.18 degrees Fahrenheit. Similarly, the maximum centered model has a y-intercept of 11.29. This represents the average minimum temperature when the sea level pressure is 0 (ie., a value of 30.82 in the original metric).</p>
<p>If the three different centered y-intercepts are compared, min-centered = 49.18, mean-centered = 27.63, and max-centered = 11.29. The mean-centered y-intercept is in between the minimum and maximum centered values, why is this occurring? This is happening due to the linear relationship that is assumed between the minimum temperature and the sea level pressure with the linear regression model. If a different functional form was assumed (ie., a curved relationship), there would likely be larger differences between the pairs of y-intercept values shown above.</p>
</div>
</div>
</div>
<div id="conditional-means" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Conditional Means</h2>
<p>To come …</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="13">
<li id="fn13"><p>Although there is an assumption that the outcome and attribute are linearly related in linear regression, it is possible to specify the model to explore non-linear trends.<a href="linear-regression.html#fnref13" class="footnote-back">↩︎</a></p></li>
<li id="fn14"><p>Dew point is the temperature to which air must be cooled to become saturated with water vapor. <a href="https://en.wikipedia.org/wiki/Dew_point">Wikipedia</a><a href="linear-regression.html#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>Gestational days is the number of days that the baby is in the womb before being born, see <a href="https://en.wikipedia.org/wiki/Gestation">gestation on Wikipedia</a><a href="linear-regression.html#fnref15" class="footnote-back">↩︎</a></p></li>
<li id="fn16"><p>See <a href="https://en.wikipedia.org/wiki/Atmospheric_pressure#Mean_sea-level_pressure">atmospheric pressure on Wikipedia</a><a href="linear-regression.html#fnref16" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regression-trees.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="estimation-bootstrap-and-uncertainty.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
