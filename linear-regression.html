<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Linear Regression | Statistical Reasoning through Computation and R</title>
  <meta name="description" content="Chapter 7 Linear Regression | Statistical Reasoning through Computation and R" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Linear Regression | Statistical Reasoning through Computation and R" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="lebebr01/stat_thinking" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Linear Regression | Statistical Reasoning through Computation and R" />
  
  
  

<meta name="author" content="Brandon LeBeau and Andrew S. Zieffler" />


<meta name="date" content="2023-10-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regression-trees.html"/>
<link rel="next" href="estimation-bootstrap-and-uncertainty.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.29/datatables.js"></script>
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-43425299-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-43425299-4');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Reasoning through Computation and R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#statistics-vs-data-science"><i class="fa fa-check"></i><b>1.1</b> Statistics vs Data Science</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#experiments-vs-observations"><i class="fa fa-check"></i><b>1.2</b> Experiments vs Observations</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#explore-random-assignment"><i class="fa fa-check"></i><b>1.2.1</b> Explore Random Assignment</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#example-natural-experiments"><i class="fa fa-check"></i><b>1.2.2</b> Example: Natural Experiments</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#data-structure"><i class="fa fa-check"></i><b>1.3</b> Data Structure</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#tabular-data"><i class="fa fa-check"></i><b>1.3.1</b> Tabular Data</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#non-tabular-data"><i class="fa fa-check"></i><b>1.3.2</b> Non-tabular Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>2</b> Visualization</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="visualization.html"><a href="visualization.html#college-scorecard-data"><i class="fa fa-check"></i><b>2.0.1</b> College Scorecard Data</a></li>
<li class="chapter" data-level="2.0.2" data-path="visualization.html"><a href="visualization.html#view-the-data"><i class="fa fa-check"></i><b>2.0.2</b> View the Data</a></li>
<li class="chapter" data-level="2.1" data-path="visualization.html"><a href="visualization.html#exploring-attributes"><i class="fa fa-check"></i><b>2.1</b> Exploring Attributes</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="visualization.html"><a href="visualization.html#histograms"><i class="fa fa-check"></i><b>2.1.1</b> Histograms</a></li>
<li class="chapter" data-level="2.1.2" data-path="visualization.html"><a href="visualization.html#interpreting-histograms"><i class="fa fa-check"></i><b>2.1.2</b> Interpreting Histograms</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="visualization.html"><a href="visualization.html#plot-customization"><i class="fa fa-check"></i><b>2.2</b> Plot Customization</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="visualization.html"><a href="visualization.html#axes-labels"><i class="fa fa-check"></i><b>2.2.1</b> Axes labels</a></li>
<li class="chapter" data-level="2.2.2" data-path="visualization.html"><a href="visualization.html#plot-title-and-subtitle"><i class="fa fa-check"></i><b>2.2.2</b> Plot title and subtitle</a></li>
<li class="chapter" data-level="2.2.3" data-path="visualization.html"><a href="visualization.html#plot-theme"><i class="fa fa-check"></i><b>2.2.3</b> Plot theme</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="visualization.html"><a href="visualization.html#density-plots"><i class="fa fa-check"></i><b>2.3</b> Density plots</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="visualization.html"><a href="visualization.html#interpreting-density-plots"><i class="fa fa-check"></i><b>2.3.1</b> Interpreting Density Plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html"><i class="fa fa-check"></i><b>3</b> Descriptive Statistics: Numerically Describing the Sample Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#summarizing-attributes"><i class="fa fa-check"></i><b>3.1</b> Summarizing Attributes</a></li>
<li class="chapter" data-level="3.2" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#understanding-the-median-and-mean"><i class="fa fa-check"></i><b>3.2</b> Understanding the Median and Mean</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#summarize-with-the-mean-or-median"><i class="fa fa-check"></i><b>3.2.1</b> Summarize with the Mean or Median?</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#numerically-summarizing-variation"><i class="fa fa-check"></i><b>3.3</b> Numerically Summarizing Variation</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#range"><i class="fa fa-check"></i><b>3.3.1</b> Range</a></li>
<li class="chapter" data-level="3.3.2" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#percentile-range"><i class="fa fa-check"></i><b>3.3.2</b> Percentile Range</a></li>
<li class="chapter" data-level="3.3.3" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#interquartile-range-iqr"><i class="fa fa-check"></i><b>3.3.3</b> Interquartile Range (IQR)</a></li>
<li class="chapter" data-level="3.3.4" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#empirical-cumulative-density"><i class="fa fa-check"></i><b>3.3.4</b> Empirical Cumulative Density</a></li>
<li class="chapter" data-level="3.3.5" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#variance-and-standard-deviation"><i class="fa fa-check"></i><b>3.3.5</b> Variance and Standard Deviation</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#summarizing-categorical-attributes"><i class="fa fa-check"></i><b>3.4</b> Summarizing Categorical Attributes</a></li>
<li class="chapter" data-level="3.5" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#advanced-extension-computing-another-measure-of-variation"><i class="fa fa-check"></i><b>3.5</b> Advanced Extension: Computing Another Measure of Variation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html"><i class="fa fa-check"></i><b>4</b> Multivariate Visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#multivariate-distributions"><i class="fa fa-check"></i><b>4.1</b> Multivariate Distributions</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#histograms-1"><i class="fa fa-check"></i><b>4.1.1</b> Histograms</a></li>
<li class="chapter" data-level="4.1.2" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#density-curves"><i class="fa fa-check"></i><b>4.1.2</b> Density Curves</a></li>
<li class="chapter" data-level="4.1.3" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#violin-plots"><i class="fa fa-check"></i><b>4.1.3</b> Violin Plots</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#faceting"><i class="fa fa-check"></i><b>4.2</b> Faceting</a></li>
<li class="chapter" data-level="4.3" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#multivariate-descriptive-statistics"><i class="fa fa-check"></i><b>4.3</b> Multivariate Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#adding-additional-groups"><i class="fa fa-check"></i><b>4.3.1</b> Adding additional groups</a></li>
<li class="chapter" data-level="4.3.2" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#adding-more-descriptive-statistics"><i class="fa fa-check"></i><b>4.3.2</b> Adding more descriptive statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>5</b> Classification</a>
<ul>
<li class="chapter" data-level="5.1" data-path="classification.html"><a href="classification.html#decision-trees"><i class="fa fa-check"></i><b>5.1</b> Decision Trees</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="classification.html"><a href="classification.html#fitting-a-classification-tree"><i class="fa fa-check"></i><b>5.1.1</b> Fitting a Classification Tree</a></li>
<li class="chapter" data-level="5.1.2" data-path="classification.html"><a href="classification.html#accuracy"><i class="fa fa-check"></i><b>5.1.2</b> Accuracy</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="classification.html"><a href="classification.html#adding-categorical-attributes"><i class="fa fa-check"></i><b>5.2</b> Adding Categorical Attributes</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="classification.html"><a href="classification.html#exploring-location"><i class="fa fa-check"></i><b>5.2.1</b> Exploring Location</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="classification.html"><a href="classification.html#comparison-to-baseline"><i class="fa fa-check"></i><b>5.3</b> Comparison to Baseline</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="classification.html"><a href="classification.html#absolute-vs-relative-comparison"><i class="fa fa-check"></i><b>5.3.1</b> Absolute vs Relative Comparison</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="classification.html"><a href="classification.html#trainingtest-data"><i class="fa fa-check"></i><b>5.4</b> Training/Test Data</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="classification.html"><a href="classification.html#splitting-the-data-into-trainingtest"><i class="fa fa-check"></i><b>5.4.1</b> Splitting the data into training/test</a></li>
<li class="chapter" data-level="5.4.2" data-path="classification.html"><a href="classification.html#evaluating-the-accuracy-of-the-testing-data"><i class="fa fa-check"></i><b>5.4.2</b> Evaluating the accuracy of the testing data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="classification.html"><a href="classification.html#introduction-to-resamplingbootstrap"><i class="fa fa-check"></i><b>5.5</b> Introduction to Resampling/Bootstrap</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="classification.html"><a href="classification.html#bootstrap-variation-in-prediction-accuracy"><i class="fa fa-check"></i><b>5.5.1</b> Bootstrap variation in prediction accuracy</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regression-trees.html"><a href="regression-trees.html"><i class="fa fa-check"></i><b>6</b> Regression Trees</a>
<ul>
<li class="chapter" data-level="6.1" data-path="regression-trees.html"><a href="regression-trees.html#predicting-act-score"><i class="fa fa-check"></i><b>6.1</b> Predicting ACT Score</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="regression-trees.html"><a href="regression-trees.html#loading-r-packages"><i class="fa fa-check"></i><b>6.1.1</b> Loading R packages</a></li>
<li class="chapter" data-level="6.1.2" data-path="regression-trees.html"><a href="regression-trees.html#visualize-distributions"><i class="fa fa-check"></i><b>6.1.2</b> Visualize distributions</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="regression-trees.html"><a href="regression-trees.html#continuous-association"><i class="fa fa-check"></i><b>6.2</b> Continuous Association</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="regression-trees.html"><a href="regression-trees.html#correlation-computation"><i class="fa fa-check"></i><b>6.2.1</b> Correlation Computation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="regression-trees.html"><a href="regression-trees.html#first-regression-tree"><i class="fa fa-check"></i><b>6.3</b> First Regression Tree</a></li>
<li class="chapter" data-level="6.4" data-path="regression-trees.html"><a href="regression-trees.html#evaluating-accuracy"><i class="fa fa-check"></i><b>6.4</b> Evaluating accuracy</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="regression-trees.html"><a href="regression-trees.html#conditional-error"><i class="fa fa-check"></i><b>6.4.1</b> Conditional Error</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="regression-trees.html"><a href="regression-trees.html#adding-more-attributes"><i class="fa fa-check"></i><b>6.5</b> Adding more attributes</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>7</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="linear-regression.html"><a href="linear-regression.html#simple-regression-continuous-predictor"><i class="fa fa-check"></i><b>7.1</b> Simple Regression continuous predictor</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="linear-regression.html"><a href="linear-regression.html#description-of-the-data"><i class="fa fa-check"></i><b>7.1.1</b> Description of the Data</a></li>
<li class="chapter" data-level="7.1.2" data-path="linear-regression.html"><a href="linear-regression.html#scatterplots"><i class="fa fa-check"></i><b>7.1.2</b> Scatterplots</a></li>
<li class="chapter" data-level="7.1.3" data-path="linear-regression.html"><a href="linear-regression.html#fitting-a-linear-regression-model"><i class="fa fa-check"></i><b>7.1.3</b> Fitting a linear regression model</a></li>
<li class="chapter" data-level="7.1.4" data-path="linear-regression.html"><a href="linear-regression.html#explore-the-y-intercept"><i class="fa fa-check"></i><b>7.1.4</b> Explore the y-intercept</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="linear-regression.html"><a href="linear-regression.html#conditional-means"><i class="fa fa-check"></i><b>7.2</b> Conditional Means</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html"><i class="fa fa-check"></i><b>8</b> Estimation, Bootstrap and Uncertainty</a>
<ul>
<li class="chapter" data-level="8.1" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#bootstrap-and-uncertainty"><i class="fa fa-check"></i><b>8.1</b> Bootstrap and Uncertainty</a></li>
<li class="chapter" data-level="8.2" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#estimating-error-or-uncertainty"><i class="fa fa-check"></i><b>8.2</b> Estimating Error or uncertainty</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#resample-with-replacement"><i class="fa fa-check"></i><b>8.2.1</b> Resample with replacement</a></li>
<li class="chapter" data-level="8.2.2" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#calculate-statistic-of-interest"><i class="fa fa-check"></i><b>8.2.2</b> Calculate statistic of interest</a></li>
<li class="chapter" data-level="8.2.3" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#replicating-the-resamplingbootstrap"><i class="fa fa-check"></i><b>8.2.3</b> Replicating the resampling/bootstrap</a></li>
<li class="chapter" data-level="8.2.4" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#linear-regression-bootstrapresampling-example"><i class="fa fa-check"></i><b>8.2.4</b> Linear regression bootstrap/resampling example</a></li>
<li class="chapter" data-level="8.2.5" data-path="estimation-bootstrap-and-uncertainty.html"><a href="estimation-bootstrap-and-uncertainty.html#determining-if-a-statistic-is-significant"><i class="fa fa-check"></i><b>8.2.5</b> Determining if a statistic is “significant”</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="linear-regression-with-categorical-predictors.html"><a href="linear-regression-with-categorical-predictors.html"><i class="fa fa-check"></i><b>9</b> Linear Regression with Categorical Predictors</a>
<ul>
<li class="chapter" data-level="9.1" data-path="linear-regression-with-categorical-predictors.html"><a href="linear-regression-with-categorical-predictors.html#categorical-predictors"><i class="fa fa-check"></i><b>9.1</b> Categorical Predictor(s)</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="linear-regression-with-categorical-predictors.html"><a href="linear-regression-with-categorical-predictors.html#linear-regression---categorical-predictor"><i class="fa fa-check"></i><b>9.1.1</b> Linear Regression - Categorical Predictor</a></li>
<li class="chapter" data-level="9.1.2" data-path="linear-regression-with-categorical-predictors.html"><a href="linear-regression-with-categorical-predictors.html#inference"><i class="fa fa-check"></i><b>9.1.2</b> Inference</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="linear-regression-with-categorical-predictors.html"><a href="linear-regression-with-categorical-predictors.html#more-than-two-categorical-groups"><i class="fa fa-check"></i><b>9.2</b> More than two categorical groups</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="linear-regression-with-categorical-predictors.html"><a href="linear-regression-with-categorical-predictors.html#explore-distribution-3-groups"><i class="fa fa-check"></i><b>9.2.1</b> Explore distribution 3 groups</a></li>
<li class="chapter" data-level="9.2.2" data-path="linear-regression-with-categorical-predictors.html"><a href="linear-regression-with-categorical-predictors.html#linear-regression-with-three-categoriesgroups"><i class="fa fa-check"></i><b>9.2.2</b> Linear Regression with three categories/groups</a></li>
<li class="chapter" data-level="9.2.3" data-path="linear-regression-with-categorical-predictors.html"><a href="linear-regression-with-categorical-predictors.html#inference-for-model-with-three-groups"><i class="fa fa-check"></i><b>9.2.3</b> Inference for model with three groups</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="linear-regression-with-categorical-predictors.html"><a href="linear-regression-with-categorical-predictors.html#exploring-model-fit"><i class="fa fa-check"></i><b>9.3</b> Exploring Model Fit</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="linear-regression-with-categorical-predictors.html"><a href="linear-regression-with-categorical-predictors.html#r-squared"><i class="fa fa-check"></i><b>9.3.1</b> R-Squared</a></li>
<li class="chapter" data-level="9.3.2" data-path="linear-regression-with-categorical-predictors.html"><a href="linear-regression-with-categorical-predictors.html#residual-standard-error"><i class="fa fa-check"></i><b>9.3.2</b> Residual Standard Error</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="linear-regression-with-categorical-predictors.html"><a href="linear-regression-with-categorical-predictors.html#multiple-regression"><i class="fa fa-check"></i><b>9.4</b> Multiple Regression</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="linear-regression-with-categorical-predictors.html"><a href="linear-regression-with-categorical-predictors.html#distribution-of-effects"><i class="fa fa-check"></i><b>9.4.1</b> Distribution of Effects</a></li>
<li class="chapter" data-level="9.4.2" data-path="linear-regression-with-categorical-predictors.html"><a href="linear-regression-with-categorical-predictors.html#interactions"><i class="fa fa-check"></i><b>9.4.2</b> Interactions</a></li>
<li class="chapter" data-level="9.4.3" data-path="linear-regression-with-categorical-predictors.html"><a href="linear-regression-with-categorical-predictors.html#evaluating-model-fit"><i class="fa fa-check"></i><b>9.4.3</b> Evaluating model fit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="prediction-for-individuals.html"><a href="prediction-for-individuals.html"><i class="fa fa-check"></i><b>10</b> Prediction for individuals</a>
<ul>
<li class="chapter" data-level="10.1" data-path="prediction-for-individuals.html"><a href="prediction-for-individuals.html#comparison-of-classification-linear-model"><i class="fa fa-check"></i><b>10.1</b> Comparison of classification / linear model</a></li>
<li class="chapter" data-level="10.2" data-path="prediction-for-individuals.html"><a href="prediction-for-individuals.html#compared-linear-model-with-median"><i class="fa fa-check"></i><b>10.2</b> Compared linear model with median</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="prediction-for-individuals.html"><a href="prediction-for-individuals.html#skewed-data---inference"><i class="fa fa-check"></i><b>10.2.1</b> Skewed Data - Inference</a></li>
<li class="chapter" data-level="10.2.2" data-path="prediction-for-individuals.html"><a href="prediction-for-individuals.html#bootstrap-median"><i class="fa fa-check"></i><b>10.2.2</b> Bootstrap Median</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Reasoning through Computation and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-regression" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Linear Regression<a href="linear-regression.html#linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Linear regression is another statistical model used when the outcome is an integer or continuous, similar to the regression tree. There are similarities between linear regression and regression trees. However, there are also very notable differences.</p>
<p>Linear regression and regression trees are used when the outcome is continuous or continuous. These methods can both make predictions for the outcome and identify which attributes are most important in aiding in making those predictions. There are differences, though, in the two methods that are important to distinguish. Linear regression assumes the relationship between the outcome and attributes entered into the model. Linear regression, as in the name, assumes that the relationship between the outcome and an attribute is linearly related.<a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a> Regression trees, however, do not directly make this linear assumption between the outcome and an attribute. This assumption can make linear regression more parsimonious, meaning that the model can be simpler, which is often a goal of science, to explain the phenomenon of interest with the simplest possible explanation.</p>
<div id="simple-regression-continuous-predictor" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Simple Regression continuous predictor<a href="linear-regression.html#simple-regression-continuous-predictor" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="description-of-the-data" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Description of the Data<a href="linear-regression.html#description-of-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>These data contain information on weather from various weather stations in the northern part of the United States during cooler months of the year (October to April). There are 3,400 observations in the data, 425 observations from each station.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="linear-regression.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb173-2"><a href="linear-regression.html#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula)</span>
<span id="cb173-3"><a href="linear-regression.html#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb173-4"><a href="linear-regression.html#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsample)</span>
<span id="cb173-5"><a href="linear-regression.html#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statthink)</span>
<span id="cb173-6"><a href="linear-regression.html#cb173-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-7"><a href="linear-regression.html#cb173-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set theme for plots</span></span>
<span id="cb173-8"><a href="linear-regression.html#cb173-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_statthinking</span>(<span class="at">base_size =</span> <span class="dv">14</span>))</span>
<span id="cb173-9"><a href="linear-regression.html#cb173-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-10"><a href="linear-regression.html#cb173-10" aria-hidden="true" tabindex="-1"></a>us_weather <span class="ot">&lt;-</span> <span class="fu">mutate</span>(us_weather, <span class="at">snow_factor =</span> <span class="fu">factor</span>(snow), </span>
<span id="cb173-11"><a href="linear-regression.html#cb173-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">snow_numeric =</span> <span class="fu">ifelse</span>(snow <span class="sc">==</span> <span class="st">&#39;Yes&#39;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code></pre></div>
<p>The station locations are shown below using the function <code>count(us_weather, location)</code> and in Table <a href="linear-regression.html#tab:locations">7.1</a>. Weather observations from these station locations were collected, including temperature, dewpoint, humidity, wind speed, precipitation type and amount, and other information.</p>
<table>
<caption><span id="tab:locations">Table 7.1: </span>Station locations for the United States weather data</caption>
<thead>
<tr class="header">
<th align="left">location</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Boston, MA</td>
<td align="right">425</td>
</tr>
<tr class="even">
<td align="left">Buffalo, NY</td>
<td align="right">425</td>
</tr>
<tr class="odd">
<td align="left">Chicago, IL</td>
<td align="right">425</td>
</tr>
<tr class="even">
<td align="left">Detroit, MI</td>
<td align="right">425</td>
</tr>
<tr class="odd">
<td align="left">Duluth, MN</td>
<td align="right">425</td>
</tr>
<tr class="even">
<td align="left">Iowa City, IA</td>
<td align="right">425</td>
</tr>
<tr class="odd">
<td align="left">Minneapolis, MN</td>
<td align="right">425</td>
</tr>
<tr class="even">
<td align="left">Portland, ME</td>
<td align="right">425</td>
</tr>
</tbody>
</table>
</div>
<div id="scatterplots" class="section level3 hasAnchor" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Scatterplots<a href="linear-regression.html#scatterplots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As we have explored before, scatterplots help to explore the relationship between two continuous, quantitative data attributes. The <code>gf_point()</code> function creates scatterplots. Adding lines to the figure to guide the relationship between the two attributes can be done with the <code>gf_smooth()</code> function. Below, a scatterplot shows the relationship between the low temperature and the average daily dew point.<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a></p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="linear-regression.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(drybulbtemp_min <span class="sc">~</span> dewpoint_avg, <span class="at">data =</span> us_weather, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb174-2"><a href="linear-regression.html#cb174-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb174-3"><a href="linear-regression.html#cb174-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_labs</span>(<span class="at">x =</span> <span class="st">&quot;Average daily dew point&quot;</span>,</span>
<span id="cb174-4"><a href="linear-regression.html#cb174-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Minimum daily temperature (in F)&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:scatter-temp"></span>
<img src="07-linear-regression_files/figure-html/scatter-temp-1.png" alt="Scatterplot showing the minimum temperature by dewpoint." width="672" />
<p class="caption">
Figure 7.1: Scatterplot showing the minimum temperature by dewpoint.
</p>
</div>
<p>Figure <a href="linear-regression.html#fig:scatter-temp">7.1</a> shows the relationship between minimum temperature and average daily dew point, assuming a linear relationship (specified with <code>gf_smooth(method = 'lm')</code>) between the two attributes. In this example, the relationship between the two attributes goes from the lower left to the upper right, indicating a positive relationship. As the average daily dew point tends to increase, the minimum daily temperature also tends to increase. The relationship is not perfect, as shown by the points not falling perfectly on the blue line, but the data are clustered relatively closely to this blue line. This would suggest that the relationship is stronger rather than weaker and closer to +1 than 0.</p>
<p>The correlation estimates the relationship between the two attributes with a single numeric quantity. The correlation can be calculated with the <code>cor()</code> function, with the primary argument being a formula depicting the two variables to compute the correlation. The optional argument, <code>use = 'complete. obs'</code> is used as there is some missing data on these attributes, and these data are removed prior to the calculation.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="linear-regression.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(drybulbtemp_min <span class="sc">~</span> dewpoint_avg, <span class="at">data =</span> us_weather, </span>
<span id="cb175-2"><a href="linear-regression.html#cb175-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">use =</span> <span class="st">&#39;complete.obs&#39;</span>)</span></code></pre></div>
<pre><code>## [1] 0.9102476</code></pre>
<p>The correlation represents the degree of <strong>linear</strong> relationship between the two variables. Values closer to 1 in absolute value (i.e., +1 or -1) show a stronger linear relationship, and values closer to 0 indicate no relationship or weaker relationship. The correlation between the two variables above was about 0.91 indicating that there is a strong positive linear relationship between the minimum temperature and the daily dew point. The correlation is positive due to the coefficient being positive, and the general trend from the scatterplot shows a direction of relationship moving from the lower left to the upper right of the figure. A negative correlation would have a negative sign associated with it and would trend from the upper left to the lower right of a scatterplot.</p>
</div>
<div id="fitting-a-linear-regression-model" class="section level3 hasAnchor" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> Fitting a linear regression model<a href="linear-regression.html#fitting-a-linear-regression-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The correlation showed evidence of a relationship between the minimum temperature and the average daily dew point. Fitting a linear regression model is often done to provide more evidence about the strength of this relationship and how much error is involved. Estimating the linear regression uses R’s <code>lm()</code> function. The two arguments that need to be specified are a formula and the data for the model fitting. The formula takes the following form: <code>drybulbtemp_min ~ dewpoint_avg</code>, where the minimum temperature is the outcome of interest (in language we have used previously, this is the attribute we want to predict) and the average daily dew point is the attribute we want to use to help to predict the minimum temperature. Another way to think about what these variables represent is to explain variation in the minimum temperature with the average daily dew point. In other words, the assumption is that the average daily dew point impacts or explains differences in the minimum temperature.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="linear-regression.html#cb177-1" aria-hidden="true" tabindex="-1"></a>temp_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(drybulbtemp_min <span class="sc">~</span> dewpoint_avg, </span>
<span id="cb177-2"><a href="linear-regression.html#cb177-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> us_weather)</span>
<span id="cb177-3"><a href="linear-regression.html#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(temp_reg)</span></code></pre></div>
<pre><code>##  (Intercept) dewpoint_avg 
##    4.8343103    0.8999469</code></pre>
<p>The following coefficients represent the linear regression equation that more generally can be shown as:</p>
<p><span class="math display">\[\begin{equation}
drybulbtemp\_min = 4.83 + 0.90 dewpoint\_avg + \epsilon
\end{equation}\]</span></p>
<p>The equation can omit the error term, <span class="math inline">\(\epsilon\)</span>, as:</p>
<p><span class="math display">\[\begin{equation}
\hat{drybulbtemp\_min} = 4.83 + 0.90 dewpoint\_avg
\end{equation}\]</span></p>
<p>the minimum temperature outcome now has a hat (i.e., <span class="math inline">\(\hat{y}\)</span>). The hat denotes mathematically that the equation predicts a value of minimum temperature given solely the average daily dew point. The first equation above says that the original observed minimum temperature is a function of the average daily dew point plus some error. Computing the predicted minimum temperature can be done by inserting a value for the average daily dew point. Let us pick a few values for the average daily dew point to try.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="linear-regression.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fl">4.83</span> <span class="sc">+</span> <span class="fl">0.90</span> <span class="sc">*</span> <span class="sc">-</span><span class="dv">15</span></span></code></pre></div>
<pre><code>## [1] -8.67</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="linear-regression.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fl">4.83</span> <span class="sc">+</span> <span class="fl">0.90</span> <span class="sc">*</span> <span class="dv">0</span></span></code></pre></div>
<pre><code>## [1] 4.83</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="linear-regression.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fl">4.83</span> <span class="sc">+</span> <span class="fl">0.90</span> <span class="sc">*</span> <span class="dv">25</span></span></code></pre></div>
<pre><code>## [1] 27.33</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="linear-regression.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fl">4.83</span> <span class="sc">+</span> <span class="fl">0.90</span> <span class="sc">*</span> <span class="dv">26</span></span></code></pre></div>
<pre><code>## [1] 28.23</code></pre>
<p>Notice that the predicted minimum temperature value increases by 0.90 degrees Fahrenheit for every one-degree increase in average daily dew point, often called the linear slope. The predicted values would fit on the line shown in Figure <a href="linear-regression.html#fig:scatter-temp">7.1</a>. This highlights the assumption made from the linear regression model in which the relationship between the minimum temperature and the average daily dew point is linear. It is possible to relax this assumption with a more complicated model. However, that is not explored here. The y-intercept, shown as 4.83 in the equations above, will be explored in the next section.</p>
</div>
<div id="explore-the-y-intercept" class="section level3 hasAnchor" number="7.1.4">
<h3><span class="header-section-number">7.1.4</span> Explore the y-intercept<a href="linear-regression.html#explore-the-y-intercept" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So far, the discussion has focused on the linear slope, often the most interesting term. However, the y-intercept can also be an important term. The y-intercept from the equations above when the minimum temperature was predicted or explained by the average daily dew point was 4.83. What does this term mean? Exploring the scatterplot can provide some insight into the interpretation of the intercept.</p>
<p>Figure <a href="linear-regression.html#fig:scatter-temp-int">7.2</a> shows a scatterplot where the y-axis is the minimum temperature, and the x-axis is the average daily dew point. This figure shows a horizontal and vertical line that crosses the blue line shown in the figure. The vertical line is shown at an average daily dew point of 0, and the horizontal line is at a minimum temperature of 4.83. These cross or intersect on the blue line, representing the relationship between the average daily dew point and the minimum temperature. This depicts the y-intercept. The y-intercept represents the average minimum temperature for a daily dew point of zero. More generally, the y-intercept is the <em>average value of the outcome when all of the attributes included in the linear regression are 0</em>.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="linear-regression.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(drybulbtemp_min <span class="sc">~</span> dewpoint_avg, <span class="at">data =</span> us_weather, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb187-2"><a href="linear-regression.html#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb187-3"><a href="linear-regression.html#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb187-4"><a href="linear-regression.html#cb187-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_hline</span>(<span class="at">yintercept =</span> <span class="fl">4.83</span>) <span class="sc">%&gt;%</span></span>
<span id="cb187-5"><a href="linear-regression.html#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_labs</span>(<span class="at">x =</span> <span class="st">&quot;Average daily dew point&quot;</span>,</span>
<span id="cb187-6"><a href="linear-regression.html#cb187-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Minimum daily temperature (in F)&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:scatter-temp-int"></span>
<img src="07-linear-regression_files/figure-html/scatter-temp-int-1.png" alt="Scatterplot showing the minimum temperature by dewpoint highlighting the intercept." width="672" />
<p class="caption">
Figure 7.2: Scatterplot showing the minimum temperature by dewpoint highlighting the intercept.
</p>
</div>
<p>In the example, a value of 0 for the average daily dew point occurs within the sample of data. That is, an average daily dew point of 0 occurs in the data and is directly interpretable. This would mean that when an average daily dew point of 0 happens in real life, the average predicted minimum temperature is 4.83 degrees Fahrenheit. In some situations, a value of 0 for an attribute is not plausible. An example could be predicting a baby’s birth weight based on the number of gestation days.<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a> In situations where the value of 0 is not plausible or meaningful, the data can be centered on a value that is more meaningful or plausible to help with the interpretation of the y-intercept.</p>
<p>Before this is done, below is a more concrete example that still tries to predict/explain minimum temperature, but now the attribute to explain differences in the minimum temperature is the average daily sea level pressure. Sea-level pressure is a way to measure atmospheric pressure and is measured in inches of mercury<a href="#fn21" class="footnote-ref" id="fnref21"><sup>21</sup></a>. Figure <a href="linear-regression.html#fig:scatter-temp-pressure">7.3</a> shows a scatterplot of this relationship. First, notice that the direction of the blue line is different than before. It starts in the upper left quadrant and decreases as the sea level pressure increases. This is indicative of a negative relationship between the two attributes. The correlation can be estimated to be -0.38, a moderate negative relationship. This relationship is weaker than the relationship between minimum temperature and average daily dew point. The variation around the blue line in <a href="linear-regression.html#fig:scatter-temp-pressure">7.3</a> is much larger, which depicts a weaker relationship (i.e., more error) compared to the minimum temperature and dew point relationship (see Figure <a href="linear-regression.html#fig:scatter-temp">7.1</a>).</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="linear-regression.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(drybulbtemp_min <span class="sc">~</span> sealevelpressure_avg, <span class="at">data =</span> us_weather, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb188-2"><a href="linear-regression.html#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb188-3"><a href="linear-regression.html#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_labs</span>(<span class="at">x =</span> <span class="st">&quot;Average daily sea level pressure&quot;</span>,</span>
<span id="cb188-4"><a href="linear-regression.html#cb188-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Minimum daily temperature (in F)&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:scatter-temp-pressure"></span>
<img src="07-linear-regression_files/figure-html/scatter-temp-pressure-1.png" alt="Scatterplot showing minimum temperature by sea level pressure." width="672" />
<p class="caption">
Figure 7.3: Scatterplot showing minimum temperature by sea level pressure.
</p>
</div>
<p>The following coefficients can be estimated, resulting in the following regression equation.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="linear-regression.html#cb189-1" aria-hidden="true" tabindex="-1"></a>sea_temp <span class="ot">&lt;-</span> <span class="fu">lm</span>(drybulbtemp_min <span class="sc">~</span> sealevelpressure_avg, <span class="at">data =</span> us_weather)</span>
<span id="cb189-2"><a href="linear-regression.html#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(sea_temp)</span></code></pre></div>
<pre><code>##          (Intercept) sealevelpressure_avg 
##            660.05123            -21.05011</code></pre>
<p><span class="math display">\[\begin{equation}
drybulbtemp\_min = 660.05 - 21.05 sealevelpressure\_avg + \epsilon
\end{equation}\]</span></p>
<p>For these, the y-intercept is about 660 degrees Fahrenheit, and the linear slope is about -21 degrees Fahrenheit. How are these interpreted? Starting with the linear slope, the -21 means that for every one-unit increase in sea level pressure (i.e., moving from 29 to 30 inches of mercury), the average minimum temperature decreases by 21 degrees Fahrenheit.</p>
<p>Why is the y-intercept 660 degrees Fahrenheit, a temperature much above water’s boiling point and hotter than most ovens? Furthermore, this is not an atmospheric temperature observed in the data, so why is the y-intercept 660 degrees Fahrenheit? Ultimately, this comes down to the range of sea level pressure, where the minimum value in the data is 29.02, a value very far from 0. Therefore, the linear relationship depicted above is extrapolated outside the range of the data (i.e., decreased by 29.02 sea level units), which increases the temperature by 610.871 degrees Fahrenheit units. This value is not interpretable or meaningful as it would be impossible to get a sea level pressure of 0 in the metric of inches of mercury. It is possible to modify the data but keep the overall relationship between minimum temperature and sea level pressure to help increase the interpretation of the y-intercept. Three options are explored: mean value-centered, minimum value-centered, and maximum value-centered, although there are many other potential options.</p>
<div id="mean-center-sea-level-pressure" class="section level4 hasAnchor" number="7.1.4.1">
<h4><span class="header-section-number">7.1.4.1</span> Mean center sea level pressure<a href="linear-regression.html#mean-center-sea-level-pressure" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>First, mean centering the x attribute can often be a way to make the y-intercept more interpretable. The code below shows a scatterplot by subtracting the mean from all the values of sea level pressure. More explicitly, the value of 30.04 was subtracted from each sea level pressure value in the data.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="linear-regression.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(drybulbtemp_min <span class="sc">~</span> <span class="fu">I</span>(sealevelpressure_avg <span class="sc">-</span> <span class="fu">mean</span>(sealevelpressure_avg, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb191-2"><a href="linear-regression.html#cb191-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> us_weather, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb191-3"><a href="linear-regression.html#cb191-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb191-4"><a href="linear-regression.html#cb191-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_labs</span>(<span class="at">x =</span> <span class="st">&quot;Average daily sea level pressure&quot;</span>,</span>
<span id="cb191-5"><a href="linear-regression.html#cb191-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Minimum daily temperature (in F)&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:scatter-mean-center"></span>
<img src="07-linear-regression_files/figure-html/scatter-mean-center-1.png" alt="Scatterplot showing the relationship between minimum temperature by sea level pressure that is mean centered." width="672" />
<p class="caption">
Figure 7.4: Scatterplot showing the relationship between minimum temperature by sea level pressure that is mean centered.
</p>
</div>
<p>Notice that the relationship is the same as before, but now the scale of sea level pressure is different. From the coefficients shown below, notice that the linear slope is the same as before, -21.05, showing that the subtraction of the mean for each value did not impact the overall relationship between the two attributes. The difference is now the y-intercept is much smaller and would represent the mean minimum temperature when the mean-centered sea level pressure is 0 (i.e., a value of 30.04 in the original metric).</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="linear-regression.html#cb192-1" aria-hidden="true" tabindex="-1"></a>sealevel_reg_centered <span class="ot">&lt;-</span> <span class="fu">lm</span>(drybulbtemp_min <span class="sc">~</span> <span class="fu">I</span>(sealevelpressure_avg <span class="sc">-</span> <span class="fu">mean</span>(sealevelpressure_avg, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb192-2"><a href="linear-regression.html#cb192-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> us_weather)</span>
<span id="cb192-3"><a href="linear-regression.html#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(sealevel_reg_centered)</span></code></pre></div>
<pre><code>##                                                        (Intercept) 
##                                                           27.63117 
## I(sealevelpressure_avg - mean(sealevelpressure_avg, na.rm = TRUE)) 
##                                                          -21.05011</code></pre>
<p>The new equation would look like:</p>
<p>begin{equation}
= 27.63 - 21.05 (sealevelpressure_avg - mean(sealevelpressure_avg))
\end{equation}</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="linear-regression.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fl">27.63</span> <span class="sc">-</span> <span class="fl">21.05</span> <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span></span></code></pre></div>
<pre><code>## [1] 48.68</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="linear-regression.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fl">27.63</span> <span class="sc">-</span> <span class="fl">21.05</span> <span class="sc">*</span> <span class="dv">0</span></span></code></pre></div>
<pre><code>## [1] 27.63</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="linear-regression.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fl">27.63</span> <span class="sc">-</span> <span class="fl">21.05</span> <span class="sc">*</span> .<span class="dv">5</span></span></code></pre></div>
<pre><code>## [1] 17.105</code></pre>
<p>This can provide a more interpretable intercept and be a direct interest model parameter. The value for the y-intercept also makes more intuitive sense, which can aid in model interpretation. This model would fit the data the same as before. That is, this model is not inherently better. Instead, the benefits of this model are simply in the interpretation and intuitiveness of the y-intercept. The regression line shown in the scatterplots in Figures <a href="linear-regression.html#fig:scatter-temp-pressure">7.3</a> and <a href="linear-regression.html#fig:scatter-mean-center">7.4</a> are the same.</p>
</div>
<div id="minimum-or-maximum-centered-sea-level-pressure" class="section level4 hasAnchor" number="7.1.4.2">
<h4><span class="header-section-number">7.1.4.2</span> Minimum or Maximum centered sea level pressure<a href="linear-regression.html#minimum-or-maximum-centered-sea-level-pressure" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Mean centering an attribute can be an attractive way to make the y-intercept more intuitive and interpretable, but there are other options. Other common options include subtracting the minimum or maximum values from the predictor attribute. The minimum-centered and then the maximum-centered regression are shown in order.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="linear-regression.html#cb200-1" aria-hidden="true" tabindex="-1"></a>sealevel_reg_min <span class="ot">&lt;-</span> <span class="fu">lm</span>(drybulbtemp_min <span class="sc">~</span> <span class="fu">I</span>(sealevelpressure_avg <span class="sc">-</span> <span class="fu">min</span>(sealevelpressure_avg, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb200-2"><a href="linear-regression.html#cb200-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> us_weather)</span>
<span id="cb200-3"><a href="linear-regression.html#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(sealevel_reg_min)</span></code></pre></div>
<pre><code>##                                                       (Intercept) 
##                                                          49.17705 
## I(sealevelpressure_avg - min(sealevelpressure_avg, na.rm = TRUE)) 
##                                                         -21.05011</code></pre>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="linear-regression.html#cb202-1" aria-hidden="true" tabindex="-1"></a>sealevel_reg_max <span class="ot">&lt;-</span> <span class="fu">lm</span>(drybulbtemp_min <span class="sc">~</span> <span class="fu">I</span>(sealevelpressure_avg <span class="sc">-</span> <span class="fu">max</span>(sealevelpressure_avg, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb202-2"><a href="linear-regression.html#cb202-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> us_weather)</span>
<span id="cb202-3"><a href="linear-regression.html#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(sealevel_reg_max)</span></code></pre></div>
<pre><code>##                                                       (Intercept) 
##                                                          11.28686 
## I(sealevelpressure_avg - max(sealevelpressure_avg, na.rm = TRUE)) 
##                                                         -21.05011</code></pre>
<p>There are two main takeaways from these new models. First, the relationship between the minimum temperature and the sea level pressure does not change. The average change in the minimum temperature for a unit change of sea level pressure is still 21 degrees Fahrenheit, and the relationship is always negative. The element that changes is the y-intercept. For the minimum centered model, the y-intercept is 49.18 degrees Fahrenheit. The interpretation is that when the sea level pressure has a value of 0 (i.e., a value of 29.02 in the original metric), the average minimum temperature is 49.18 degrees Fahrenheit. Similarly, the maximum centered model has a y-intercept of 11.29. This represents the average minimum temperature when the sea level pressure is 0 (i.e., a value of 30.82 in the original metric).</p>
<p>If the three different centered y-intercepts are compared, min-centered = 49.18, mean-centered = 27.63, and max-centered = 11.29. The mean-centered y-intercept is in between the minimum and maximum centered values. Why is this occurring? This happens due to the linear relationship assumed between the minimum temperature and the sea level pressure with the linear regression model. If a different functional form were assumed (i.e., a curved relationship), there would likely be larger differences between the pairs of y-intercept values shown above.</p>
</div>
</div>
</div>
<div id="conditional-means" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Conditional Means<a href="linear-regression.html#conditional-means" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To come …</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="18">
<li id="fn18"><p>Although there is an assumption that the outcome and attribute are linearly related in linear regression, it is possible to specify the model to explore non-linear trends.<a href="linear-regression.html#fnref18" class="footnote-back">↩︎</a></p></li>
<li id="fn19"><p>Dew point is the temperature to which air must be cooled to become saturated with water vapor. <a href="https://en.wikipedia.org/wiki/Dew_point">Wikipedia</a><a href="linear-regression.html#fnref19" class="footnote-back">↩︎</a></p></li>
<li id="fn20"><p>Gestational days is the number of days the baby is in the womb before birth. See <a href="https://en.wikipedia.org/wiki/Gestation">gestation on Wikipedia</a><a href="linear-regression.html#fnref20" class="footnote-back">↩︎</a></p></li>
<li id="fn21"><p>See <a href="https://en.wikipedia.org/wiki/Atmospheric_pressure#Mean_sea-level_pressure">atmospheric pressure on Wikipedia</a><a href="linear-regression.html#fnref21" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regression-trees.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="estimation-bootstrap-and-uncertainty.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
